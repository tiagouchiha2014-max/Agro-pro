function boot(){if(!document.getElementById("globalStyles")){const e=document.createElement("style");e.id="globalStyles",e.innerHTML="\n      .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }\n      \n      /* Tabelas Responsivas ‚Äî Mobile card layout */\n      @media (max-width: 768px) {\n        .tableWrap { border: none; }\n        table, thead, tbody, th, td, tr { display: block; }\n        thead tr { position: absolute; top: -9999px; left: -9999px; }\n        tr { border: 1px solid var(--border, #e2e8f0); border-radius: 8px; margin-bottom: 10px; background: var(--surface, white); padding: 10px; }\n        td { border: none; position: relative; padding-left: 50%; text-align: right; min-height: 30px; display: flex; align-items: center; justify-content: flex-end; }\n        td:before { content: attr(data-label); position: absolute; left: 10px; width: 45%; padding-right: 10px; white-space: nowrap; text-align: left; font-weight: bold; color: var(--text-muted, #64748b); }\n      }\n      \n      /* IA Chat Styles */\n      .chat-container { height: 500px; display: flex; flex-direction: column; background: var(--bg-subtle, #f1f5f9); border-radius: var(--radius, 12px); overflow: hidden; border: 1px solid var(--border, #e2e8f0); }\n      .chat-messages { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }\n      .msg { max-width: 80%; padding: 12px 16px; border-radius: var(--radius, 12px); font-size: 14px; line-height: 1.5; }\n      .msg.user { align-self: flex-end; background: var(--brand, #2d7d32); color: white; border-bottom-right-radius: 2px; }\n      .msg.bot { align-self: flex-start; background: var(--surface, white); color: var(--text); border-bottom-left-radius: 2px; border: 1px solid var(--border, #e2e8f0); }\n      .chat-input { padding: 15px; background: var(--surface, white); border-top: 1px solid var(--border, #e2e8f0); display: flex; gap: 10px; }\n      \n      .plan-basic { background: rgba(255,255,255,0.12); color: rgba(255,255,255,0.6); }\n      .plan-basico { background: rgba(255,255,255,0.12); color: rgba(255,255,255,0.6); }\n      .plan-trial { background: rgba(255,255,255,0.12); color: rgba(255,255,255,0.6); }\n",document.head.appendChild(e)}const e=document.body.getAttribute("data-page")||"dashboard",a={dashboard:["Dashboard","Vis√£o geral da safra atual"],centralgestao:["Central de Gest√£o","Alertas, custos e cota√ß√£o de gr√£os"],safras:["Minha Propriedade","Safras, fazendas e talh√µes"],fazendas:["Minha Propriedade","Safras, fazendas e talh√µes"],talhoes:["Minha Propriedade","Safras, fazendas e talh√µes"],produtos:["Produtos & Estoque","Insumos da safra"],estoque:["Produtos & Estoque","Insumos da safra"],insumos:["Produtos & Estoque","Produtos, estoque e insumos da safra"],insumosbase:["Insumos Base","Aduba√ß√£o e insumos de base por talh√£o"],aplicacoes:["Aplica√ß√µes","Opera√ß√µes da safra"],combustivel:["Combust√≠vel","Entradas e sa√≠das de diesel"],clima:["Clima/Chuva","Registros clim√°ticos da safra"],colheitas:["Colheitas","Produ√ß√£o real e frete da safra"],manutencao:["Manuten√ß√£o","Manuten√ß√£o de m√°quinas e equipamentos"],equipe:["Equipe","Colaboradores da safra"],folhasalarial:["Folha Salarial","Gest√£o de pagamentos e sal√°rios da equipe"],analisesolo:["An√°lise de Solo","Laudos, fertilidade e recomenda√ß√µes por talh√£o"],maquinas:["M√°quinas","Equipamentos da safra"],relatorios:["Relat√≥rios","Exporta√ß√£o de dados da safra"],config:["Configura√ß√µes","Par√¢metros e backup"],copilot:["Agro-Copilot","Assistente de IA para sua fazenda"],ia:["Intelig√™ncia Artificial","Funcionalidades IA ‚Äî em desenvolvimento"],"ia-preditiva":["IA Preditiva","Previs√µes e an√°lises avan√ßadas ‚Äî em desenvolvimento"],ajuda:["Ajuda & Suporte","Centro de Ajuda e Documenta√ß√£o"],propriedade:["Minha Propriedade","Safras, fazendas e talh√µes"]};if(localStorage.removeItem("agro_pro_openai_key"),localStorage.removeItem("agro_openai_key"),sessionStorage.removeItem("agro_pro_openai_key"),"login"!==e){if("undefined"!=typeof AuthService&&"function"==typeof isSupabaseReady&&isSupabaseReady())return void AuthService.getSession().then(async o=>{if(!o||!o.user)return localStorage.removeItem("agro_session"),void pageLogin();const t=await AuthService.getUserProfile();if(!t){const o=localStorage.getItem("agro_session");if(o)try{return userSession=JSON.parse(o),userRole=userSession?.user?.role||localStorage.getItem("agro_role")||"admin",trialInfo=null,planoAtual=localStorage.getItem("agro_plano")||"Free",void _renderPageAfterAuth(e,a)}catch(e){}return["agro_session","agro_role","agro_trial","agro_plano"].forEach(e=>localStorage.removeItem(e)),isSupabaseReady()&&await AuthService.signOut().catch(()=>{}),void pageLogin()}userSession={user:{id:o.user.id,email:o.user.email,nome:t?.full_name||"",role:t?.user_role||"admin"}},localStorage.setItem("agro_session",JSON.stringify(userSession)),userRole=t?.user_role||"admin",localStorage.setItem("agro_role",userRole),t?.plan_type&&(planoAtual={free:"Free",trial:"Free",basico:"Free",pro:"Pro",master:"Master"}[t.plan_type]||"Free",localStorage.setItem("agro_plano",planoAtual)),trialInfo=null,localStorage.removeItem("agro_trial"),_renderPageAfterAuth(e,a)}).catch(()=>{const o=localStorage.getItem("agro_session");if(o)try{userSession=JSON.parse(o),userRole=userSession?.user?.role||localStorage.getItem("agro_role")||"admin",trialInfo=null,planoAtual=localStorage.getItem("agro_plano")||"Free",_renderPageAfterAuth(e,a)}catch(e){localStorage.removeItem("agro_session"),pageLogin()}else pageLogin()});{const o=localStorage.getItem("agro_session");if(o)try{userSession=JSON.parse(o),userRole=userSession?.user?.role||localStorage.getItem("agro_role")||"admin",trialInfo=null,planoAtual=localStorage.getItem("agro_plano")||"Free",window._offlineMode=!0,_renderPageAfterAuth(e,a)}catch(e){pageLogin()}else pageLogin();return}}if("login"===e)return localStorage.getItem("agro_session")?void(window.location.href="index.html"):void pageLogin()}function _renderPageAfterAuth(e,a){trialInfo=getTrialInfo();const o=localStorage.getItem("agro_plano")||"Trial";if("Trial"===o){if(trialInfo&&trialInfo.expirado)return void pageTrialExpirado();planoAtual="Trial"}else planoAtual=o;const[t,r]=a[e]||["Agro Pro",""];renderShell(e,t,r);const s=renderTrialBanner();if(s){const e=document.querySelector(".main");e&&e.insertAdjacentHTML("afterbegin",s)}if(window._offlineMode){const e=document.querySelector(".main");e&&e.insertAdjacentHTML("afterbegin",'\n        <div id="offlineBanner" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 10px 20px; text-align: center; font-size: 13px; font-weight: 500; position: sticky; top: 0; z-index: 9998;">\n          üì¥ <b>Modo Offline</b> ‚Äî Sem conex√£o com o Supabase. Seus dados locais est√£o dispon√≠veis, mas altera√ß√µes n√£o ser√£o sincronizadas at√© a reconex√£o.\n        </div>\n      ')}canAccessPage(e)?"dashboard"===e?pageDashboard():"centralgestao"===e?pageCentralGestao():"insumos"===e?pageInsumos():"produtos"===e?pageProdutos():"estoque"===e||"estoque"===e?pageEstoque():"insumosbase"===e?pageInsumosBase():"aplicacoes"===e?pageAplicacoes():"combustivel"===e?pageCombustivel():"clima"===e?pageClima():"colheitas"===e?pageColheitas():"manutencao"===e?pageManutencao():"equipe"===e?pageEquipe():"folhasalarial"===e?pageFolhaSalarial():"analisesolo"===e?pageAnaliseSolo():"maquinas"===e?pageMaquinas():"relatorios"===e?pageRelatorios():"copilot"===e?pageCopilot():"ia"===e||"ia-preditiva"===e?document.getElementById("content").innerHTML=_renderIAComingSoon("ia"===e?"Intelig√™ncia Artificial":"IA Preditiva","Estamos desenvolvendo funcionalidades avan√ßadas de IA para potencializar sua gest√£o agr√≠cola.",[{icon:"üß†",title:"IA Preditiva",desc:"Previs√£o de produtividade e an√°lise de risco por talh√£o"},{icon:"üåø",title:"Detec√ß√£o de Pragas",desc:"Identifica√ß√£o autom√°tica com base em dados clim√°ticos"},{icon:"üíä",title:"Receitu√°rio IA",desc:"Recomenda√ß√µes de defensivos baseadas no seu hist√≥rico"},{icon:"üìà",title:"Tend√™ncias",desc:"An√°lise de tend√™ncias de pre√ßo e produtividade"}]):"ajuda"===e?pageAjuda():"config"===e?pageConfiguracoes():"propriedade"===e?pagePropriedade():"insumos"===e?pageInsumos():"produtos"===e?pageProdutos():"estoque"===e&&pageEstoque():document.getElementById("content").innerHTML=`\n      <div class="card" style="text-align:center; padding:40px;">\n        <h2>üö´ Acesso Restrito</h2>\n        <p style="color:#64748b;">Seu perfil de <b>${getRoleLabel()}</b> n√£o tem permiss√£o para acessar esta p√°gina.</p>\n        <a href="index.html" class="btn primary" style="margin-top:15px;">Voltar ao Dashboard</a>\n      </div>\n    `;const n=document.querySelector(".sidebar > div:last-child");function i(){var e=document.getElementById("cloudStatusIndicator");if(e){var a=!0===window._cloudConnected||"function"==typeof isSupabaseReady&&isSupabaseReady();e.textContent=a?"‚òÅÔ∏è Conectado":"üì¥ Offline",a?(e.classList.add("text-success"),e.classList.remove("text-warning")):(e.classList.add("text-warning"),e.classList.remove("text-success"))}}n&&n.insertAdjacentHTML("beforeend",'\n      <div id="cloudStatusIndicator" style="margin-top: 8px; font-size: 10px; text-align: center;"></div>\n    '),i(),setInterval(i,5e3),"function"!=typeof cloudSync||window._offlineMode||(sessionStorage.getItem("_cloudRestored")||"function"!=typeof cloudRestore?cloudSync():(sessionStorage.setItem("_cloudRestored","1"),cloudRestore().then(e=>{e?location.reload():cloudSync()}).catch(()=>cloudSync())))}document.addEventListener("DOMContentLoaded",boot);