const CACHE_NAME="agropro-v11.0",STATIC_CACHE="agropro-static-v11.0",DYNAMIC_CACHE="agropro-dynamic-v1",OFFLINE_PAGE="/offline.html",PRECACHE_URLS=["/","/index.html","/assets/style.css?v=11.0","/assets/supabase-client.js?v=11.0","/assets/modules/core.js?v=11.0","/assets/modules/shell.js?v=11.0","/assets/modules/login.js?v=11.0","/assets/modules/app-init.js?v=11.0","/assets/modules/dashboard.js?v=11.0","/assets/modules/propriedade.js?v=11.0","/assets/modules/safras.js?v=11.0","/assets/modules/centralgestao.js?v=11.0","/assets/modules/fazendas.js?v=11.0","/assets/modules/talhoes.js?v=11.0","/assets/modules/insumos.js?v=11.0","/assets/modules/produtos.js?v=11.0","/assets/modules/estoque.js?v=11.0","/assets/modules/insumosbase.js?v=11.0","/assets/modules/aplicacoes.js?v=11.0","/assets/modules/combustivel.js?v=11.0","/assets/modules/clima.js?v=11.0","/assets/modules/colheitas.js?v=11.0","/assets/modules/manutencao.js?v=11.0","/assets/modules/equipe.js?v=11.0","/assets/modules/folhaSalarial.js?v=11.0","/assets/modules/analiseSolo.js?v=11.0","/assets/modules/maquinas.js?v=11.0","/assets/modules/relatorios.js?v=11.0","/assets/modules/configuracoes.js?v=11.0","/assets/modules/ajuda.js?v=11.0","/assets/modules/ia-helpers.js?v=11.0","/assets/modules/defensivos.js?v=11.0","/assets/modules/copilot.js?v=11.0","/assets/modules/pagamento.js?v=11.0","/assets/icon-192.png","/assets/icon-512.png","/manifest.json","/favicon.ico","/offline.html"],HTML_PAGES=["/ajuda.html","/analisesolo.html","/aplicacoes.html","/centralgestao.html","/clima.html","/colheitas.html","/combustivel.html","/configuracoes.html","/copilot.html","/equipe.html","/estoque.html","/fazendas.html","/folhasalarial.html","/insumos.html","/insumosbase.html","/manutencao.html","/maquinas.html","/produtos.html","/propriedade.html","/relatorios.html","/safras.html","/talhoes.html"];self.addEventListener("install",s=>{s.waitUntil(caches.open(STATIC_CACHE).then(s=>Promise.allSettled(PRECACHE_URLS.map(e=>s.add(e).catch(()=>{})))).then(()=>self.skipWaiting()))}),self.addEventListener("activate",s=>{s.waitUntil(caches.keys().then(s=>Promise.all(s.filter(s=>s!==STATIC_CACHE&&s!==DYNAMIC_CACHE).map(s=>caches.delete(s)))).then(()=>self.clients.claim()))}),self.addEventListener("fetch",s=>{const{request:e}=s,t=new URL(e.url);"GET"===e.method&&(t.hostname.includes("supabase.co")||t.hostname.includes("open-meteo.com")||t.hostname.includes("vercel-insights.com")||t.hostname.includes("va.vercel-scripts.com")||t.pathname.startsWith("/_vercel/")||t.pathname.includes("/functions/v1/")||("cdn.jsdelivr.net"!==t.hostname?t.pathname.startsWith("/assets/")||"/manifest.json"===t.pathname||"/favicon.ico"===t.pathname?s.respondWith(caches.match(e).then(s=>{const t=fetch(e).then(s=>{if(s.ok){const t=s.clone();caches.open(STATIC_CACHE).then(s=>s.put(e,t))}return s}).catch(()=>s);return s||t})):t.pathname.endsWith(".html")||"/"===t.pathname||""===t.pathname?s.respondWith(fetch(e).then(s=>{if(s.ok){const t=s.clone();caches.open(DYNAMIC_CACHE).then(s=>s.put(e,t))}return s}).catch(()=>caches.match(e).then(s=>s||caches.match(OFFLINE_PAGE)||caches.match("/index.html")))):s.respondWith(caches.match(e).then(s=>{const t=fetch(e).then(s=>{if(s.ok){const t=s.clone();caches.open(DYNAMIC_CACHE).then(s=>s.put(e,t))}return s}).catch(()=>s);return s||t})):s.respondWith(caches.match(e).then(s=>s||fetch(e).then(s=>{if(s.ok){const t=s.clone();caches.open(STATIC_CACHE).then(s=>s.put(e,t))}return s})))))}),self.addEventListener("message",s=>{"skipWaiting"===s.data&&self.skipWaiting(),"clearCache"===s.data&&caches.keys().then(s=>s.forEach(s=>caches.delete(s)))});